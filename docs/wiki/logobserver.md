# AREG SDK Log Observer Application

The **AREG SDK Log Observer** is a standalone console tool application designed to gather and manage log data from [Log Collector](./logger.md) service within the AREG SDK environment. It receives the log entries to save in the text file and/or in SQLite database, and gives possibilities to manipulate scope activation status and filter log message priorities during runtime.

## Table of Contents
1. [General Information](#general-information)
2. [Log Observer Setup](#log-observer-setup)
3. [Log Observer Configuration](#log-observer-configuration)
4. [Command Line Options](#command-line-options)
5. [Connection Initialization](#connection-initialization)

---

## General Information

The AREG SDK Log Observer acts as a client application of the networking Log Collector service within the AREG SDK's logging ecosystem. It receives logs generated by multiple distributed applications to save the logs in the centralized file as a plain text or in a SQLite database for further analyzes. Additionally, it establishes bi-directional communication with the log producing application giving possibility to the users to manipulate the logging scope activation status and set the log message priorities during application runtime to reduce the network traffic and receive only necessary and valuable messages for the analyzes. 

---

## Log Observer Setup

The Log Observer is implemented within the AREG SDK [logobserver](./../../framework/logobserver/) module. It uses the `areglogger` utility library and compiled as a standalone executable that can run as a console application on Windows and Linux. Deployment can occur on any networked machine with a **General Purpose Operating System (GPOS)**.

To start receiving the log data, start the console application on any GPOS machine within a network.

---

## Log Observer Configuration

As any other AREG Framework based application, the **logobserver** settings are managed within a configuration file, typically found as [areg.init](./../../framework/areg/resources/areg.init). Settings use key-value pairs in the format `section::(module|*)::property[::(position|*)]`. Example configurations for the Log Observer and any other application within AREG SDK echosystem:

```plaintext
logger::*::service          = logger        # Log Collector process name
logger::*::connect          = tcpip         # Communication protocol
logger::*::enable::tcpip    = true          # Enable TCP/IP
logger::*::address::tcpip   = 172.23.96.1   # IP address (default: 127.0.0.1)
logger::*::port::tcpip      = 8282          # Port number (default: 8282)
```

These configurations enable applications to establish network connections with the Log Collector for logging. Applications can log messages, and log observers receive the data for real-time insights.

Setting descriptions:
- `logger::*::service` .......: Specifies the log collector process name.
- `logger::*::connect` .......: Lists supported protocols (TCP/IP in this example).
- `logger::*::enable::tcpip` .: Activates or deactivates the protocol.
- `logger::*::address::tcpip` : Specifies the Log Collector’s network-accessible IP.
- `logger::*::port::tcpip` ...: Assigns the port number.

For further details, refer to the [AREG SDK Persistence Syntax documentation](./persistence-syntax.md).

Additionally, the `logobserver` application has log specific settings:
```plaintext
# ---------------------------------------------------------------------------
# Message layout for log observer
# ---------------------------------------------------------------------------
log::logobserver::layout::enter     = %d: [ %a.%x.%t.%z: Enter -->]%n
log::logobserver::layout::message   = %d: [ %a.%x.%t.%p >>> ] %m%n
log::logobserver::layout::exit      = %d: [ %a.%x.%t.%z: Exit <-- ]%n

# ---------------------------------------------------------------------------
# Log observer specific database logging settings
# ---------------------------------------------------------------------------
log::logobserver::enable::file      = true
log::logobserver::enable::db        = true
log::logobserver::db::name          = sqlite3
log::logobserver::db::location      = ./logs/log_%time%.sqlite3
```

In this configuration of `areg.init`, the `logobserver` application can save received log messages in the plain text file (setting `log::logobserver::enable::file = true`) and in the database (setting `log::logobserver::enable::db = true`). Additionally, it is specified the layout of the received log messages in the plain text file and the type of database (`sqlite3`).

> [!TIP]
> To disable saving logs in the text file, it is enough to change to `log::logobserver::enable::file = false`.

---

## Command Line Options

The Log Observer's console application key command-line options are listed below for starting and controlling its operation. Options, marked as **Console**, can be entered while `logobserver` is active; others start the program.

| Command               | Platform  | Description                   | Usage Example                     |
|-----------------------|-----------|-------------------------------|-----------------------------------|
| `-e, --query`         | Console   | Display list of log scopes    | `-e someapp`                      |
| `-f, --config`        | Console   | Save current configuration    | `-f`                              |
| `-h, --help`          | All       | Display help message          | `logobserver --help`              |
| `-l, --load`          | All       | Load configuration file       | `logobserver -l="config.init"`    |
| `-n, --instances`     | Console   | Show connected instances      | `-n`                              |
| `-o, --scope`         | Console   | Set scope priority            | `-o someapp::scope_*=DEBUG`       |
| `-p, --pause`         | Console   | Pause log observer            | `-p`                              |
| `-q, --quit`          | Console   | Quit console application      | `-q`                              |
| `-r, --restart`       | Console   | Restart connections           | `-r`                              |
| `-x, --stop`          | Console   | Stop log observer             | `-x`                              |

Commands may vary with version updates.

---

## Connection Initialization

By default, `logobserver` loads settings from `areg.init`. Specify a different configuration file as follows:

```bash
logobserver --load="./my/config/file.init"
```

> [!NOTE]
> By default, in `areg.init` configuration file the logs of `logger` and `logobserver` are deactivated:
> ```plaintext
> log::logger::scope::* = NOTSET
> log::logobserver::scope::* = NOTSET
> ```
