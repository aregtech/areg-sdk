name: CLA Check
on:
  pull_request:
    types: [opened, edited, reopened, synchronize]

jobs:
  cla-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check CLA acknowledgment
        uses: actions/github-script@v7
        with:
          script: |
            const prBody = context.payload.pull_request.body || '';
            // List of required checklist items (must be checked)
            const requiredChecks = [
              '- [x] I have read, understood and agreed to the **[Areg SDK Contributor License Agreement (CLA) v1.0](../CLA.md)**.'
            ];

            const missing = requiredChecks.filter(item => !prBody.includes(item));
            if (missing.length > 0) {
              core.setFailed(
                `CLA check failed. Please make sure all checklist items are checked:\n${missing.join('\n')}`
              );
            }
