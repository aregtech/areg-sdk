/************************************************************************
 * This file is part of the AREG SDK core engine.
 * AREG SDK is dual-licensed under Free open source (Apache version 2.0
 * License) and Commercial (with various pricing models) licenses, depending
 * on the nature of the project (commercial, research, academic or free).
 * You should have received a copy of the AREG SDK license description in LICENSE.txt.
 * If not, please contact to info[at]aregtech.com
 *
 * \copyright   (c) 2017-2023 Aregtech UG. All rights reserved.
 * \file        areg/base/private/NEString.cpp
 * \ingroup     AREG SDK, Automated Real-time Event Grid Software Development Kit 
 * \author      Artak Avetyan
 * \brief       AREG Platform, Debugging utilities
 *
 ************************************************************************/

/************************************************************************
 * Include files.
 ************************************************************************/

#include "areg/base/NEString.hpp"

/************************************************************************/
// Defines
// No special meaning, only short meanings
/************************************************************************/
#define DUMMY   static_cast<uint16_t>(NEString::eCharDefs::CD_Undefined                                         )   /* Dummy */
#define EOFS    static_cast<uint16_t>(NEString::eCharDefs::CD_EOfS                                              )   /* End of string, null-termination */
#define EOFL    static_cast<uint16_t>(NEString::eCharDefs::CD_EndOfLine  | NEString::eCharDefs::CD_WhiteSpace   )   /* End of line, regardless only '\n' is defining, but using to make binary buffer readable */
#define DEOL    static_cast<uint16_t>(NEString::eCharDefs::CD_CarReturn  | NEString::eCharDefs::CD_EndOfLine    )   /* DOS End of Line, used only for carriage return */
#define SPACE   static_cast<uint16_t>(NEString::eCharDefs::CD_WhiteSpace | NEString::eCharDefs::CD_Delimiter    )   /* White space, used for trimming, as we as syntax separator */
#define CTRL    static_cast<uint16_t>(NEString::eCharDefs::CD_Control    | NEString::eCharDefs::CD_WhiteSpace   )   /* Control key value, also used to specify white space in conversion of binary buffer to readable */
#define PRINT   static_cast<uint16_t>(NEString::eCharDefs::CD_Printable                                         )   /* All printable characters, symbols and numbers, which may change text, including tab and whitespace */
#define NUMBER  static_cast<uint16_t>(NEString::eCharDefs::CD_Number     | NEString::eCharDefs::CD_Printable    )   /* All numbers */
#define SYMBOL  static_cast<uint16_t>(NEString::eCharDefs::CD_Symbol     | NEString::eCharDefs::CD_Printable    )   /* All symbols */
#define LET_UP  static_cast<uint16_t>(NEString::eCharDefs::CD_LetterUp   | NEString::eCharDefs::CD_Printable    )   /* All upper case letters */
#define LET_LO  static_cast<uint16_t>(NEString::eCharDefs::CD_LetterLo   | NEString::eCharDefs::CD_Printable    )   /* All lower case letters */

namespace
{
    /**
     * \brief   The table of first 256 symbols based on UTF-8 code page.
     *          Reference: https://www.charset.org/utf-8
     **/
    constexpr unsigned short  UTF8_256_Table[] =
    {
        /*   0 -   0 */   EOFS  | EOFL | CTRL                                                                           //   '\0', Null, end of string
        /*   1 -   4 */ , EOFL  | CTRL          , EOFL | CTRL           , EOFL | CTRL           , EOFL | CTRL           //    1 == SOH  ,   2 == STX    ,   3 == ETX    ,   4 == EOT
        /*   5 -   8 */ , EOFL  | CTRL          , EOFL | CTRL           , EOFL | CTRL           , EOFL | CTRL           //    5 == ENQ  ,   6 == ACK    ,   7 == BEL    ,   8 == '\b'
        /*   9 -  12 */ , SPACE | CTRL | PRINT  , EOFL | CTRL | PRINT   , PRINT | CTRL          , EOFL | CTRL           //    9 == '\t' ,  10 == '\n'   ,  11 == '\v'   ,  12 == '\f'
        /*  13 -  16 */ , DEOL  | CTRL | PRINT  , EOFL | CTRL           , EOFL | CTRL           , EOFL | CTRL           //   13 == '\r' ,  14 == SO     ,  15 == SI     ,  16 == DLE
        /*  17 -  20 */ , EOFL  | CTRL          , EOFL | CTRL           , EOFL | CTRL           , EOFL | CTRL           //   17 == DC1  ,  18 == DC2    ,  19 == DC3    ,  20 == DC4
        /*  21 -  24 */ , EOFL  | CTRL          , EOFL | CTRL           , EOFL | CTRL           , EOFL | CTRL           //   21 == NAK  ,  22 == SYN    ,  23 == ETB    ,  24 == CAN
        /*  25 -  28 */ , EOFL  | CTRL          , EOFL | CTRL           , EOFL | CTRL           , EOFL | CTRL           //   25 == EM   ,  26 == SUB    ,  27 == ESC    ,  28 == FS
        /*  29 -  32 */ , EOFL  | CTRL          , EOFL | CTRL           , EOFL | CTRL           , SPACE| PRINT          //   29 == GS   ,  30 == RS     ,  31 == US     ,  32 == ' '
        /*  33 -  36 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //   33 == '!'  ,  34 == '\"'   ,  35 == '#'    ,  36 == '$'
        /*  37 -  40 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //   37 == '%'  ,  38 == '&'    ,  39 == '\''   ,  40 == '('
        /*  41 -  44 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //   41 == ')'  ,  42 == '*'    ,  43 == '+'    ,  44 == ','
        /*  45 -  48 */ , SYMBOL                , SYMBOL                , SYMBOL                , NUMBER                //   45 == '-'  ,  46 == '.'    ,  47 == '/'    ,  48 == '0'
        /*  49 -  52 */ , NUMBER                , NUMBER                , NUMBER                , NUMBER                //   49 == '1'  ,  50 == '2'    ,  51 == '3'    ,  52 == '4'
        /*  53 -  56 */ , NUMBER                , NUMBER                , NUMBER                , NUMBER                //   53 == '5'  ,  54 == '6'    ,  55 == '7'    ,  56 == '8'
        /*  57 -  60 */ , NUMBER                , SYMBOL                , SYMBOL                , SYMBOL                //   57 == '9'  ,  58 == ':'    ,  59 == ';'    ,  60 == '<'
        /*  61 -  64 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //   61 == '='  ,  62 == '>'    ,  63 == '?'    ,  64 == '@'
        /*  65 -  68 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //   65 == 'A'  ,  66 == 'B'    ,  67 == 'C'    ,  68 == 'D'
        /*  69 -  72 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //   69 == 'E'  ,  70 == 'F'    ,  71 == 'G'    ,  72 == 'H'
        /*  73 -  76 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //   73 == 'I'  ,  74 == 'J'    ,  74 == 'K'    ,  76 == 'L'
        /*  77 -  80 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //   77 == 'M'  ,  78 == 'N'    ,  79 == 'O'    ,  80 == 'P'
        /*  81 -  84 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //   81 == 'Q'  ,  82 == 'R'    ,  83 == 'S'    ,  84 == 'T'
        /*  85 -  88 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //   85 == 'U'  ,  86 == 'V'    ,  87 == 'W'    ,  88 == 'X'
        /*  89 -  92 */ , LET_UP                , LET_UP                , SYMBOL                , SYMBOL                //   89 == 'Y'  ,  90 == 'Z'    ,  91 == '['    ,  92 == '\\'
        /*  93 -  96 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //   93 == ']'  ,  94 == '^'    ,  95 == '_'    ,  96 == '`'
        /*  97 - 100 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //   97 == 'a'  ,  98 == 'b'    ,  99 == 'c'    , 100 == 'd'
        /* 101 - 104 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  101 == 'e'  , 102 == 'f'    , 103 == 'g'    , 104 == 'h'
        /* 105 - 108 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  105 == 'i'  , 106 == 'j'    , 107 == 'k'    , 108 == 'l'
        /* 109 - 112 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  109 == 'm'  , 110 == 'n'    , 111 == 'o'    , 112 == 'p'
        /* 113 - 116 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  113 == 'q'  , 114 == 'r'    , 115 == 's'    , 116 == 't'
        /* 117 - 120 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  117 == 'u'  , 118 == 'v'    , 119 == 'w'    , 120 == 'x'
        /* 121 - 124 */ , LET_LO                , LET_LO                , SYMBOL                , SYMBOL                //  121 == 'y'  , 122 == 'z'    , 123 == '{'    , 124 == '|'
        /* 125 - 128 */ , SYMBOL                , SYMBOL                , EOFL   | CTRL         , SYMBOL | CTRL         //  125 == '}'  , 126 == '~'    , 127 == DEL    , 128 == '€' 
        /* 129 - 132 */ , DUMMY  | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         //  129         , 130 == '‚'    , 131 == 'ƒ'    , 132 == '„'
        /* 133 - 136 */ , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         //  133 == '…'  , 134 == '†'    , 135 == '‡'    , 136 == 'ˆ'
        /* 137 - 140 */ , SYMBOL | CTRL         , LET_UP | CTRL         , SYMBOL | CTRL         , LET_UP | CTRL         //  137 == '‰'  , 138 == 'Š'    , 139 == '‹'    , 140 == 'Œ	'
        /* 141 - 144 */ , EOFL   | CTRL         , LET_UP | CTRL         , EOFL   | CTRL         , EOFL   | CTRL         //  141         , 142 == 'Ž'    , 143           , 144
        /* 145 - 148 */ , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         //  145 == '‘'  , 146 == '’'    , 147 == '“'    , 148 == '”'
        /* 149 - 152 */ , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         , SYMBOL | CTRL         //  149 == '•'  , 150 == '–'    , 151 == '—'    , 152 == '˜"
        /* 153 - 156 */ , SYMBOL | CTRL         , LET_LO | CTRL         , SYMBOL | CTRL         , LET_LO | CTRL         //  153 == '™'  , 154 == 'š'    , 155 == '›'    , 156 == 'œ'
        /* 157 - 160 */ , EOFL   | CTRL         , LET_LO | CTRL         , LET_UP | CTRL         , SYMBOL                //  157         , 158 == 'ž'    , 159 == 'Ÿ'    , 160 == ' ' (No-break Space)
        /* 161 - 164 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //  161 == '¡'  , 162 == '¢'    , 163 == '£'    , 164 == '¤'
        /* 165 - 168 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //  165 == '¥'  , 166 == '¦'    , 167 == '§'    , 168 == '¨'
        /* 169 - 172 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //  169 == '©'  , 170 == 'ª'    , 171 == '«'    , 172 == '¬'
        /* 173 - 176 */ , CTRL                  , SYMBOL                , SYMBOL                , SYMBOL                //  173         , 174 == '®'    , 175 == '¯'    , 176 == '°'
        /* 177 - 180 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //  177 == '±'  , 178 == '²'    , 179 == '³'    , 180 == '´'
        /* 181 - 184 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //  181 == 'µ'  , 182 == '¶'    , 183 == '·'    , 184 == '¸'
        /* 185 - 188 */ , SYMBOL                , SYMBOL                , SYMBOL                , SYMBOL                //  185 == '¹'  , 186 == 'º'    , 187 == '»'    , 188 == '¼'
        /* 189 - 192 */ , SYMBOL                , SYMBOL                , SYMBOL                , LET_UP                //  189 == '½'  , 190 == '¾'    , 191 == '¿'    , 192 == 'À'
        /* 193 - 196 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //  193 == 'Á'  , 194 == 'Â'    , 195 == 'Ã'    , 196 == 'Ä'
        /* 197 - 200 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //  197 == 'Å'  , 198 == 'Æ'    , 199 == 'Ç'    , 200 == 'È'
        /* 201 - 204 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //  201 == 'É'  , 202 == 'Ê'    , 203 == 'Ë'    , 204 == 'Ì'
        /* 205 - 208 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //  205 == 'Í'  , 206 == 'Î'    , 207 == 'Ï'    , 208 == 'Ð'
        /* 209 - 212 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //  209 == 'Ñ'  , 210 == 'Ò'    , 211 == 'Ó'    , 212 == 'Ô'
        /* 213 - 216 */ , LET_UP                , LET_UP                , SYMBOL                , LET_UP                //  213 == 'Õ'  , 214 == 'Ö'    , 215 == '×'    , 216 == 'Ø'
        /* 217 - 220 */ , LET_UP                , LET_UP                , LET_UP                , LET_UP                //  217 == 'Ù'  , 218 == 'Ú'    , 219 == 'Û'    , 220 == 'Ü'
        /* 221 - 224 */ , LET_UP                , LET_UP                , LET_LO                , LET_LO                //  221 == 'Ý'  , 222 == 'Þ'    , 223 == 'ß'    , 224 == 'à'
        /* 225 - 228 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  225 == 'á'  , 226 == 'â'    , 227 == 'ã'    , 228 == 'ä'
        /* 229 - 232 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  229 == 'å'  , 230 == 'æ'    , 231 == 'ç'    , 232 == 'è'
        /* 233 - 236 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  233 == 'é'  , 234 == 'ê'    , 235 == 'ë'    , 236 == 'ì'
        /* 237 - 240 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  237 == 'í'  , 238 == 'î'    , 239 == 'ï'    , 240 == 'ð'
        /* 241 - 244 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  241 == 'ñ'  , 242 == 'ò'    , 243 == 'ó'    , 244 == 'ô'
        /* 245 - 248 */ , LET_LO                , LET_LO                , SYMBOL                , LET_LO                //  245 == 'õ'  , 246 == 'ö'    , 247 == '÷'    , 248 == 'ø'
        /* 249 - 252 */ , LET_LO                , LET_LO                , LET_LO                , LET_LO                //  249 == 'ù'  , 250 == 'ú'    , 251 == 'û'    , 252 == 'ü'
        /* 253 - 255 */ , LET_LO                , LET_LO                , LET_LO                                        //  253 == 'ý'  , 254 == 'þ'    , 255 == 'ÿ'
    };

    /**
     * \brief   The table lower case letters and symbols based on first 256 of UTF-8 code page.
     *          Reference: https://www.charset.org/utf-8
     **/
    constexpr unsigned char  UTF8_256_Table_lower[] =
    {
        /*   0 -   0 */     0                                                                                           //   '\0', end of string
        /*   1 -   4 */ ,   1                   ,   2                   ,   3                   ,   4                   //    1 == SOH  ,   2 == STX    ,   3 == ETX    ,   4 == EOT
        /*   5 -   8 */ ,   5                   ,   6                   ,   7                   ,   8                   //    5 == ENQ  ,   6 == ACK    ,   7 == BEL    ,   8 == '\b'
        /*   9 -  12 */ ,   9                   ,  10                   ,  11                   ,  12                   //    9 == '\t' ,  10 == '\n'   ,  11 == '\v'   ,  12 == '\f'
        /*  13 -  16 */ ,  13                   ,  14                   ,  15                   ,  16                   //   13 == '\r' ,  14 == SO     ,  15 == SI     ,  16 == DLE
        /*  17 -  20 */ ,  17                   ,  18                   ,  19                   ,  20                   //   17 == DC1  ,  18 == DC2    ,  19 == DC3    ,  20 == DC4
        /*  21 -  24 */ ,  21                   ,  22                   ,  23                   ,  24                   //   21 == NAK  ,  22 == SYN    ,  23 == ETB    ,  24 == CAN
        /*  25 -  28 */ ,  25                   ,  26                   ,  27                   ,  28                   //   25 == EM   ,  26 == SUB    ,  27 == ESC    ,  28 == FS
        /*  29 -  32 */ ,  29                   ,  30                   ,  31                   ,  32                   //   29 == GS   ,  30 == RS     ,  31 == US     ,  32 == ' '
        /*  33 -  36 */ ,  33                   ,  34                   ,  35                   ,  36                   //   33 == '!'  ,  34 == '\"'   ,  35 == '#'    ,  36 == '$'
        /*  37 -  40 */ ,  37                   ,  38                   ,  39                   ,  40                   //   37 == '%'  ,  38 == '&'    ,  39 == '\''   ,  40 == '('
        /*  41 -  44 */ ,  41                   ,  42                   ,  43                   ,  44                   //   41 == ')'  ,  42 == '*'    ,  43 == '+'    ,  44 == ','
        /*  45 -  48 */ ,  45                   ,  46                   ,  47                   ,  48                   //   45 == '-'  ,  46 == '.'    ,  47 == '/'    ,  48 == '0'
        /*  49 -  52 */ ,  49                   ,  50                   ,  51                   ,  52                   //   49 == '1'  ,  50 == '2'    ,  51 == '3'    ,  52 == '4'
        /*  53 -  56 */ ,  53                   ,  54                   ,  55                   ,  56                   //   53 == '5'  ,  54 == '6'    ,  55 == '7'    ,  56 == '8'
        /*  57 -  60 */ ,  57                   ,  58                   ,  59                   ,  60                   //   57 == '9'  ,  58 == ':'    ,  59 == ';'    ,  60 == '<'
        /*  61 -  64 */ ,  61                   ,  62                   ,  63                   ,  64                   //   61 == '='  ,  62 == '>'    ,  63 == '?'    ,  64 == '@'
        /*  65 -  68 */ ,  97 /* 'a' */         ,  98 /* 'b' */         ,  99 /* 'c' */         , 100 /* 'd' */         //   65 == 'A'  ,  66 == 'B'    ,  67 == 'C'    ,  68 == 'D'
        /*  69 -  72 */ , 101 /* 'e' */         , 102 /* 'f' */         , 103 /* 'g' */         , 104 /* 'h' */         //   69 == 'E'  ,  70 == 'F'    ,  71 == 'G'    ,  72 == 'H'
        /*  73 -  76 */ , 105 /* 'i' */         , 106 /* 'j' */         , 107 /* 'k' */         , 108 /* 'l' */         //   73 == 'I'  ,  74 == 'J'    ,  74 == 'K'    ,  76 == 'L'
        /*  77 -  80 */ , 109 /* 'm' */         , 110 /* 'n' */         , 111 /* 'o' */         , 112 /* 'p' */         //   77 == 'M'  ,  78 == 'N'    ,  79 == 'O'    ,  80 == 'P'
        /*  81 -  84 */ , 113 /* 'q' */         , 114 /* 'r' */         , 115 /* 's' */         , 116 /* 't' */         //   81 == 'Q'  ,  82 == 'R'    ,  83 == 'S'    ,  84 == 'T'
        /*  85 -  88 */ , 117 /* 'u' */         , 118 /* 'v' */         , 119 /* 'w' */         , 120 /* 'x' */         //   85 == 'U'  ,  86 == 'V'    ,  87 == 'W'    ,  88 == 'X'
        /*  89 -  92 */ , 121 /* 'y' */         , 122 /* 'z' */         ,  91                   ,  92                   //   89 == 'Y'  ,  90 == 'Z'    ,  91 == '['    ,  92 == '\\'
        /*  93 -  96 */ ,  93                   ,  94                   ,  95                   ,  96                   //   93 == ']'  ,  94 == '^'    ,  95 == '_'    ,  96 == '`'
        /*  97 - 100 */ ,  97 /* 'a' */         ,  98 /* 'b' */         ,  99 /* 'c' */         , 100 /* 'd' */         //   97 == 'a'  ,  98 == 'b'    ,  99 == 'c'    , 100 == 'd'
        /* 101 - 104 */ , 101 /* 'e' */         , 102 /* 'f' */         , 103 /* 'g' */         , 104 /* 'h' */         //  101 == 'e'  , 102 == 'f'    , 103 == 'g'    , 104 == 'h'
        /* 105 - 108 */ , 105 /* 'i' */         , 106 /* 'j' */         , 107 /* 'k' */         , 108 /* 'l' */         //  105 == 'i'  , 106 == 'j'    , 107 == 'k'    , 108 == 'l'
        /* 109 - 112 */ , 109 /* 'm' */         , 110 /* 'n' */         , 111 /* 'o' */         , 112 /* 'p' */         //  109 == 'm'  , 110 == 'n'    , 111 == 'o'    , 112 == 'p'
        /* 113 - 116 */ , 113 /* 'q' */         , 114 /* 'r' */         , 115 /* 's' */         , 116 /* 't' */         //  113 == 'q'  , 114 == 'r'    , 115 == 's'    , 116 == 't'
        /* 117 - 120 */ , 117 /* 'u' */         , 118 /* 'v' */         , 119 /* 'w' */         , 120 /* 'x' */         //  117 == 'u'  , 118 == 'v'    , 119 == 'w'    , 120 == 'x'
        /* 121 - 124 */ , 121 /* 'y' */         , 122 /* 'z' */         , 123                   , 124                   //  121 == 'y'  , 122 == 'z'    , 123 == '{'    , 124 == '|'
        /* 125 - 128 */ , 125                   , 126                   , 127                   , 128                   //  125 == '}'  , 126 == '~'    , 127 == DEL    , 128 == '€' 
        /* 129 - 132 */ , 129                   , 130                   , 131                   , 132                   //  129         , 130 == '‚'    , 131 == 'ƒ'    , 132 == '„'
        /* 133 - 136 */ , 133                   , 134                   , 135                   , 136                   //  133 == '…'  , 134 == '†'    , 135 == '‡'    , 136 == 'ˆ'
        /* 137 - 140 */ , 137                   , 154 /* 'š' */         , 139                   , 156 /* 'œ' */         //  137 == '‰'  , 138 == 'Š'    , 139 == '‹'    , 140 == 'Œ	'
        /* 141 - 144 */ , 141                   , 158 /* 'ž' */         , 143                   , 144                   //  141         , 142 == 'Ž'    , 143           , 144
        /* 145 - 148 */ , 145                   , 146                   , 147                   , 148                   //  145 == '‘'  , 146 == '’'    , 147 == '“'    , 148 == '”'
        /* 149 - 152 */ , 149                   , 150                   , 151                   , 152                   //  149 == '•'  , 150 == '–'    , 151 == '—'    , 152 == '˜"
        /* 153 - 156 */ , 153                   , 154 /* 'š' */         , 155                   , 156 /* 'œ' */         //  153 == '™'  , 154 == 'š'    , 155 == '›'    , 156 == 'œ'
        /* 157 - 160 */ , 157                   , 158 /* 'ž' */         , 255 /* 'ÿ' */         , 160                   //  157         , 158 == 'ž'    , 159 == 'Ÿ'    , 160 == ' ' (No-break Space)
        /* 161 - 164 */ , 161                   , 162                   , 163                   , 164                   //  161 == '¡'  , 162 == '¢'    , 163 == '£'    , 164 == '¤'
        /* 165 - 168 */ , 165                   , 166                   , 167                   , 168                   //  165 == '¥'  , 166 == '¦'    , 167 == '§'    , 168 == '¨'
        /* 169 - 172 */ , 169                   , 170                   , 171                   , 172                   //  169 == '©'  , 170 == 'ª'    , 171 == '«'    , 172 == '¬'
        /* 173 - 176 */ , 173                   , 174                   , 175                   , 176                   //  173         , 174 == '®'    , 175 == '¯'    , 176 == '°'
        /* 177 - 180 */ , 177                   , 178                   , 179                   , 180                   //  177 == '±'  , 178 == '²'    , 179 == '³'    , 180 == '´'
        /* 181 - 184 */ , 181                   , 182                   , 183                   , 184                   //  181 == 'µ'  , 182 == '¶'    , 183 == '·'    , 184 == '¸'
        /* 185 - 188 */ , 185                   , 186                   , 187                   , 188                   //  185 == '¹'  , 186 == 'º'    , 187 == '»'    , 188 == '¼'
        /* 189 - 192 */ , 189                   , 190                   , 191                   , 224 /* 'à' */         //  189 == '½'  , 190 == '¾'    , 191 == '¿'    , 192 == 'À'
        /* 193 - 196 */ , 225 /* 'á' */         , 226 /* 'â' */         , 227 /* 'ã' */         , 228 /* 'ä' */         //  193 == 'Á'  , 194 == 'Â'    , 195 == 'Ã'    , 196 == 'Ä'
        /* 197 - 200 */ , 229 /* 'å' */         , 230 /* 'æ' */         , 231 /* 'ç' */         , 232 /* 'è' */         //  197 == 'Å'  , 198 == 'Æ'    , 199 == 'Ç'    , 200 == 'È'
        /* 201 - 204 */ , 233 /* 'é' */         , 234 /* 'ê' */         , 235 /* 'ë' */         , 236 /* 'ì' */         //  201 == 'É'  , 202 == 'Ê'    , 203 == 'Ë'    , 204 == 'Ì'
        /* 205 - 208 */ , 237 /* 'í' */         , 238 /* 'î' */         , 239 /* 'ï' */         , 240 /* 'ð' */         //  205 == 'Í'  , 206 == 'Î'    , 207 == 'Ï'    , 208 == 'Ð'
        /* 209 - 212 */ , 241 /* 'ñ' */         , 242 /* 'ò' */         , 243 /* 'ó' */         , 244 /* 'ô' */         //  209 == 'Ñ'  , 210 == 'Ò'    , 211 == 'Ó'    , 212 == 'Ô'
        /* 213 - 216 */ , 245 /* 'õ' */         , 246 /* 'ö' */         , 215                   , 248 /* 'ø' */         //  213 == 'Õ'  , 214 == 'Ö'    , 215 == '×'    , 216 == 'Ø'
        /* 217 - 220 */ , 249 /* 'ù' */         , 250 /* 'ú' */         , 251 /* 'û' */         , 252 /* 'ü' */         //  217 == 'Ù'  , 218 == 'Ú'    , 219 == 'Û'    , 220 == 'Ü'
        /* 221 - 224 */ , 253 /* 'ý' */         , 254 /* 'þ' */         , 223 /* 'ß' */         , 224 /* 'à' */         //  221 == 'Ý'  , 222 == 'Þ'    , 223 == 'ß'    , 224 == 'à'
        /* 225 - 228 */ , 225 /* 'á' */         , 226 /* 'â' */         , 227 /* 'ã' */         , 228 /* 'ä' */         //  225 == 'á'  , 226 == 'â'    , 227 == 'ã'    , 228 == 'ä'
        /* 229 - 232 */ , 229 /* 'å' */         , 230 /* 'æ' */         , 231 /* 'ç' */         , 232 /* 'è' */         //  229 == 'å'  , 230 == 'æ'    , 231 == 'ç'    , 232 == 'è'
        /* 233 - 236 */ , 233 /* 'é' */         , 234 /* 'ê' */         , 235 /* 'ë' */         , 236 /* 'ì' */         //  233 == 'é'  , 234 == 'ê'    , 235 == 'ë'    , 236 == 'ì'
        /* 237 - 240 */ , 237 /* 'í' */         , 238 /* 'î' */         , 239 /* 'ï' */         , 240 /* 'ð' */         //  237 == 'í'  , 238 == 'î'    , 239 == 'ï'    , 240 == 'ð'
        /* 241 - 244 */ , 241 /* 'ñ' */         , 242 /* 'ò' */         , 243 /* 'ó' */         , 244 /* 'ô' */         //  241 == 'ñ'  , 242 == 'ò'    , 243 == 'ó'    , 244 == 'ô'
        /* 245 - 248 */ , 245 /* 'õ' */         , 246 /* 'ö' */         , 247                   , 248 /* 'ø' */         //  245 == 'õ'  , 246 == 'ö'    , 247 == '÷'    , 248 == 'ø'
        /* 249 - 252 */ , 249 /* 'ù' */         , 250 /* 'ú' */         , 251 /* 'û' */         , 252 /* 'ü' */         //  249 == 'ù'  , 250 == 'ú'    , 251 == 'û'    , 252 == 'ü'
        /* 253 - 255 */ , 253 /* 'ý' */         , 254 /* 'þ' */         , 255 /* 'ÿ' */                                 //  253 == 'ý'  , 254 == 'þ'    , 255 == 'ÿ'
    };

    /**
     * \brief   The table upper case letters and symbols based on first 256 of UTF-8 code page.
     *          Reference: https://www.charset.org/utf-8
     **/
    constexpr unsigned char  UTF8_256_Table_upper[] =
    {
        /*   0 -   0 */     0                                                                                           //   '\0', end of string
        /*   1 -   4 */ ,   1                   ,   2                   ,   3                   ,   4                   //    1 == SOH  ,   2 == STX    ,   3 == ETX    ,   4 == EOT
        /*   5 -   8 */ ,   5                   ,   6                   ,   7                   ,   8                   //    5 == ENQ  ,   6 == ACK    ,   7 == BEL    ,   8 == '\b'
        /*   9 -  12 */ ,   9                   ,  10                   ,  11                   ,  12                   //    9 == '\t' ,  10 == '\n'   ,  11 == '\v'   ,  12 == '\f'
        /*  13 -  16 */ ,  13                   ,  14                   ,  15                   ,  16                   //   13 == '\r' ,  14 == SO     ,  15 == SI     ,  16 == DLE
        /*  17 -  20 */ ,  17                   ,  18                   ,  19                   ,  20                   //   17 == DC1  ,  18 == DC2    ,  19 == DC3    ,  20 == DC4
        /*  21 -  24 */ ,  21                   ,  22                   ,  23                   ,  24                   //   21 == NAK  ,  22 == SYN    ,  23 == ETB    ,  24 == CAN
        /*  25 -  28 */ ,  25                   ,  26                   ,  27                   ,  28                   //   25 == EM   ,  26 == SUB    ,  27 == ESC    ,  28 == FS
        /*  29 -  32 */ ,  29                   ,  30                   ,  31                   ,  32                   //   29 == GS   ,  30 == RS     ,  31 == US     ,  32 == ' '
        /*  33 -  36 */ ,  33                   ,  34                   ,  35                   ,  36                   //   33 == '!'  ,  34 == '\"'   ,  35 == '#'    ,  36 == '$'
        /*  37 -  40 */ ,  37                   ,  38                   ,  39                   ,  40                   //   37 == '%'  ,  38 == '&'    ,  39 == '\''   ,  40 == '('
        /*  41 -  44 */ ,  41                   ,  42                   ,  43                   ,  44                   //   41 == ')'  ,  42 == '*'    ,  43 == '+'    ,  44 == ','
        /*  45 -  48 */ ,  45                   ,  46                   ,  47                   ,  48                   //   45 == '-'  ,  46 == '.'    ,  47 == '/'    ,  48 == '0'
        /*  49 -  52 */ ,  49                   ,  50                   ,  51                   ,  52                   //   49 == '1'  ,  50 == '2'    ,  51 == '3'    ,  52 == '4'
        /*  53 -  56 */ ,  53                   ,  54                   ,  55                   ,  56                   //   53 == '5'  ,  54 == '6'    ,  55 == '7'    ,  56 == '8'
        /*  57 -  60 */ ,  57                   ,  58                   ,  59                   ,  60                   //   57 == '9'  ,  58 == ':'    ,  59 == ';'    ,  60 == '<'
        /*  61 -  64 */ ,  61                   ,  62                   ,  63                   ,  64                   //   61 == '='  ,  62 == '>'    ,  63 == '?'    ,  64 == '@'
        /*  65 -  68 */ ,  65 /* 'A' */         ,  66 /* 'B' */         ,  67 /* 'C' */         ,  68 /* 'D' */         //   65 == 'A'  ,  66 == 'B'    ,  67 == 'C'    ,  68 == 'D'
        /*  69 -  72 */ ,  69 /* 'E' */         ,  70 /* 'F' */         ,  71 /* 'G' */         ,  72 /* 'H' */         //   69 == 'E'  ,  70 == 'F'    ,  71 == 'G'    ,  72 == 'H'
        /*  73 -  76 */ ,  73 /* 'I' */         ,  74 /* 'J' */         ,  75 /* 'K' */         ,  76 /* 'L' */         //   73 == 'I'  ,  74 == 'J'    ,  74 == 'K'    ,  76 == 'L'
        /*  77 -  80 */ ,  77 /* 'M' */         ,  78 /* 'N' */         ,  79 /* 'O' */         ,  80 /* 'P' */         //   77 == 'M'  ,  78 == 'N'    ,  79 == 'O'    ,  80 == 'P'
        /*  81 -  84 */ ,  81 /* 'Q' */         ,  82 /* 'R' */         ,  83 /* 'S' */         ,  84 /* 'T' */         //   81 == 'Q'  ,  82 == 'R'    ,  83 == 'S'    ,  84 == 'T'
        /*  85 -  88 */ ,  85 /* 'U' */         ,  86 /* 'V' */         ,  87 /* 'W' */         ,  88 /* 'X' */         //   85 == 'U'  ,  86 == 'V'    ,  87 == 'W'    ,  88 == 'X'
        /*  89 -  92 */ ,  89 /* 'Y' */         ,  90 /* 'Z' */         ,  91                   ,  92                   //   89 == 'Y'  ,  90 == 'Z'    ,  91 == '['    ,  92 == '\\'
        /*  93 -  96 */ ,  93                   ,  94                   ,  95                   ,  96                   //   93 == ']'  ,  94 == '^'    ,  95 == '_'    ,  96 == '`'
        /*  97 - 100 */ ,  65 /* 'A' */         ,  66 /* 'B' */         ,  67 /* 'C' */         ,  68 /* 'D' */         //   97 == 'a'  ,  98 == 'b'    ,  99 == 'c'    , 100 == 'd'
        /* 101 - 104 */ ,  69 /* 'E' */         ,  70 /* 'F' */         ,  71 /* 'G' */         ,  72 /* 'H' */         //  101 == 'e'  , 102 == 'f'    , 103 == 'g'    , 104 == 'h'
        /* 105 - 108 */ ,  73 /* 'I' */         ,  74 /* 'J' */         ,  75 /* 'K' */         ,  76 /* 'L' */         //  105 == 'i'  , 106 == 'j'    , 107 == 'k'    , 108 == 'l'
        /* 109 - 112 */ ,  77 /* 'M' */         ,  78 /* 'N' */         ,  79 /* 'O' */         ,  80 /* 'P' */         //  109 == 'm'  , 110 == 'n'    , 111 == 'o'    , 112 == 'p'
        /* 113 - 116 */ ,  81 /* 'Q' */         ,  82 /* 'R' */         ,  83 /* 'S' */         ,  84 /* 'T' */         //  113 == 'q'  , 114 == 'r'    , 115 == 's'    , 116 == 't'
        /* 117 - 120 */ ,  85 /* 'U' */         ,  86 /* 'V' */         ,  87 /* 'W' */         ,  88 /* 'X' */         //  117 == 'u'  , 118 == 'v'    , 119 == 'w'    , 120 == 'x'
        /* 121 - 124 */ ,  89 /* 'Y' */         ,  90 /* 'Z' */         , 123                   , 124                   //  121 == 'y'  , 122 == 'z'    , 123 == '{'    , 124 == '|'
        /* 125 - 128 */ , 125                   , 126                   , 127                   , 128                   //  125 == '}'  , 126 == '~'    , 127 == DEL    , 128 == '€' 
        /* 129 - 132 */ , 129                   , 130                   , 131                   , 132                   //  129         , 130 == '‚'    , 131 == 'ƒ'    , 132 == '„'
        /* 133 - 136 */ , 133                   , 134                   , 135                   , 136                   //  133 == '…'  , 134 == '†'    , 135 == '‡'    , 136 == 'ˆ'
        /* 137 - 140 */ , 137                   , 138 /* 'Š' */         , 139                   , 140 /* 'Œ' */         //  137 == '‰'  , 138 == 'Š'    , 139 == '‹'    , 140 == 'Œ	'
        /* 141 - 144 */ , 141                   , 142 /* 'Ž' */         , 143                   , 144                   //  141         , 142 == 'Ž'    , 143           , 144
        /* 145 - 148 */ , 145                   , 146                   , 147                   , 148                   //  145 == '‘'  , 146 == '’'    , 147 == '“'    , 148 == '”'
        /* 149 - 152 */ , 149                   , 150                   , 151                   , 152                   //  149 == '•'  , 150 == '–'    , 151 == '—'    , 152 == '˜"
        /* 153 - 156 */ , 153                   , 138 /* 'Š' */         , 155                   , 140 /* 'Œ' */         //  153 == '™'  , 154 == 'š'    , 155 == '›'    , 156 == 'œ'
        /* 157 - 160 */ , 157                   , 142 /* 'Ž' */         , 159 /* 'Ÿ' */         , 160                   //  157         , 158 == 'ž'    , 159 == 'Ÿ'    , 160 == ' ' (No-break Space)
        /* 161 - 164 */ , 161                   , 162                   , 163                   , 164                   //  161 == '¡'  , 162 == '¢'    , 163 == '£'    , 164 == '¤'
        /* 165 - 168 */ , 165                   , 166                   , 167                   , 168                   //  165 == '¥'  , 166 == '¦'    , 167 == '§'    , 168 == '¨'
        /* 169 - 172 */ , 169                   , 170                   , 171                   , 172                   //  169 == '©'  , 170 == 'ª'    , 171 == '«'    , 172 == '¬'
        /* 173 - 176 */ , 173                   , 174                   , 175                   , 176                   //  173         , 174 == '®'    , 175 == '¯'    , 176 == '°'
        /* 177 - 180 */ , 177                   , 178                   , 179                   , 180                   //  177 == '±'  , 178 == '²'    , 179 == '³'    , 180 == '´'
        /* 181 - 184 */ , 181                   , 182                   , 183                   , 184                   //  181 == 'µ'  , 182 == '¶'    , 183 == '·'    , 184 == '¸'
        /* 185 - 188 */ , 185                   , 186                   , 187                   , 188                   //  185 == '¹'  , 186 == 'º'    , 187 == '»'    , 188 == '¼'
        /* 189 - 192 */ , 189                   , 190                   , 191                   , 192 /* 'À' */         //  189 == '½'  , 190 == '¾'    , 191 == '¿'    , 192 == 'À'
        /* 193 - 196 */ , 193 /* 'Á' */         , 194 /* 'Â' */         , 195 /* 'Ã' */         , 196 /* 'Ä' */         //  193 == 'Á'  , 194 == 'Â'    , 195 == 'Ã'    , 196 == 'Ä'
        /* 197 - 200 */ , 197 /* 'Å' */         , 198 /* 'Æ' */         , 199 /* 'Ç' */         , 200 /* 'È' */         //  197 == 'Å'  , 198 == 'Æ'    , 199 == 'Ç'    , 200 == 'È'
        /* 201 - 204 */ , 201 /* 'É' */         , 202 /* 'Ê' */         , 203 /* 'Ë' */         , 204 /* 'Ì' */         //  201 == 'É'  , 202 == 'Ê'    , 203 == 'Ë'    , 204 == 'Ì'
        /* 205 - 208 */ , 205 /* 'Í' */         , 206 /* 'Î' */         , 207 /* 'Ï' */         , 208 /* 'Ð' */         //  205 == 'Í'  , 206 == 'Î'    , 207 == 'Ï'    , 208 == 'Ð'
        /* 209 - 212 */ , 209 /* 'Ñ' */         , 210 /* 'Ò' */         , 211 /* 'Ó' */         , 212 /* 'Ô' */         //  209 == 'Ñ'  , 210 == 'Ò'    , 211 == 'Ó'    , 212 == 'Ô'
        /* 213 - 216 */ , 213 /* 'Õ' */         , 214 /* 'Ö' */         , 215                   , 216 /* 'Ø' */         //  213 == 'Õ'  , 214 == 'Ö'    , 215 == '×'    , 216 == 'Ø'
        /* 217 - 220 */ , 217 /* 'Ù' */         , 218 /* 'Ú' */         , 219 /* 'Û' */         , 220 /* 'Ü' */         //  217 == 'Ù'  , 218 == 'Ú'    , 219 == 'Û'    , 220 == 'Ü'
        /* 221 - 224 */ , 221 /* 'Ý' */         , 222 /* 'Þ' */         , 223 /* 'ß' */         , 192 /* 'À' */         //  221 == 'Ý'  , 222 == 'Þ'    , 223 == 'ß'    , 224 == 'à'
        /* 225 - 228 */ , 193 /* 'Á' */         , 194 /* 'Â' */         , 195 /* 'Ã' */         , 196 /* 'Ä' */         //  225 == 'á'  , 226 == 'â'    , 227 == 'ã'    , 228 == 'ä'
        /* 229 - 232 */ , 197 /* 'Å' */         , 198 /* 'Æ' */         , 199 /* 'Ç' */         , 200 /* 'È' */         //  229 == 'å'  , 230 == 'æ'    , 231 == 'ç'    , 232 == 'è'
        /* 233 - 236 */ , 201 /* 'É' */         , 202 /* 'Ê' */         , 203 /* 'Ë' */         , 204 /* 'Ì' */         //  233 == 'é'  , 234 == 'ê'    , 235 == 'ë'    , 236 == 'ì'
        /* 237 - 240 */ , 205 /* 'Í' */         , 206 /* 'Î' */         , 207 /* 'Ï' */         , 208 /* 'Ð' */         //  237 == 'í'  , 238 == 'î'    , 239 == 'ï'    , 240 == 'ð'
        /* 241 - 244 */ , 209 /* 'Ñ' */         , 210 /* 'Ò' */         , 211 /* 'Ó' */         , 212 /* 'Ô' */         //  241 == 'ñ'  , 242 == 'ò'    , 243 == 'ó'    , 244 == 'ô'
        /* 245 - 248 */ , 213 /* 'Õ' */         , 214 /* 'Ö' */         , 247                   , 216 /* 'Ø' */         //  245 == 'õ'  , 246 == 'ö'    , 247 == '÷'    , 248 == 'ø'
        /* 249 - 252 */ , 217 /* 'Ù' */         , 218 /* 'Ú' */         , 219 /* 'Û' */         , 220 /* 'Ü' */         //  249 == 'ù'  , 250 == 'ú'    , 251 == 'û'    , 252 == 'ü'
        /* 253 - 255 */ , 221 /* 'Ý' */         , 222 /* 'Þ' */         , 159 /* 'Ÿ' */                                 //  253 == 'ý'  , 254 == 'þ'    , 255 == 'ÿ'
    };
}

/************************************************************************/
// NEString namespace global method implementation
/************************************************************************/

AREG_API_IMPL unsigned short NEString::getUTF8_256CharDef( int ch )
{
    return static_cast<unsigned short>(ch >= -128 && ch <= 127 ? UTF8_256_Table[static_cast<unsigned char>(ch & 0xFF)] : DUMMY);
}

AREG_API_IMPL unsigned int NEString::makeUTF8_256LowerChar( int ch )
{
    return (ch >= -128 && ch <= 127 ? static_cast<unsigned int>(UTF8_256_Table_lower[static_cast<unsigned char>(ch & 0xFF)]) : static_cast<unsigned int>(ch));
}

AREG_API_IMPL unsigned int NEString::makeUTF8_256UpperChar( int ch )
{
    return (ch >= -128 && ch <= 127 ? static_cast<unsigned int>(UTF8_256_Table_upper[static_cast<unsigned char>(ch & 0xFF)]) : static_cast<unsigned int>(ch));
}
